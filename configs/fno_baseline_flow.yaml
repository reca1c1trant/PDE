# FNO Baseline Training Configuration - Flow Mixing Equation
#
# Pure Fourier Neural Operator as baseline comparison.
#
# PDE: du/dt + a*du/dx + b*du/dy = 0
# where a(x,y), b(x,y) are spatially varying coefficients
#
# Uses 2nd order upwind scheme for PDE loss (n-PINN style)

# Model Configuration
model:
  type: fno                               # Use FNO baseline
  in_channels: 6                          # Padded to 6 channels (only 1 real)
  out_channels: 6
  width: 64                               # Hidden channel width
  modes: 32                               # Fourier modes to keep
  n_layers: 4                             # Number of FNO blocks

# Dataset
dataset:
  path: "./flow_mixing_vtmax0.2_0.6_res128_t1000_n100.h5"
  temporal_length: 16                     # Will load 17 frames (16+1)
  train_ratio: 0.9
  seed: 42
  clips_per_sample: 100                   # K clips per sample per epoch

# Physics parameters
physics:
  dt: 0.001001001                         # 1/999, time step
  Lx: 1.0                                 # Domain size x
  Ly: 1.0                                 # Domain size y

# DataLoader
dataloader:
  batch_size: 16                          # Batch size
  num_workers: 4
  pin_memory: true

# Training
training:
  max_epochs: 50
  warmup_steps: 200
  learning_rate: 1.0e-3
  min_lr: 1.0e-5
  weight_decay: 1.0e-4
  betas: [0.9, 0.999]
  grad_clip: 1.0

  # Loss weights
  lambda_pde: 1.0                         # PDE residual loss weight (2nd order upwind)
  lambda_rmse: 1.0                        # RMSE loss weight
  lambda_bc: 1.0                          # Boundary loss weight (4 edges RMSE)

  mixed_precision: "bf16"
  gradient_accumulation_steps: 1
  eval_interval: 100
  early_stopping_patience: 30

# Logging
logging:
  project: "pde-fno-baseline-flow"
  entity: "reca1c1trant-ntu"
  save_dir: "./checkpoints_fno_baseline_flow"
  log_interval: 10
