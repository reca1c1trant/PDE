# UNet Baseline Training Configuration - Burgers Equation
#
# PDE Loss: Conservative flux form (n-PINN style)
# UNet: Tanh activation, BatchNorm2d
#
# Burgers: u_t + (u*u)_x + (v*u)_y = ν∇²u
#          v_t + (u*v)_x + (v*v)_y = ν∇²v

# Model Configuration
model:
  type: unet
  in_channels: 2                       # u, v channels
  out_channels: 2
  init_features: 32
  use_positional_embedding: true
  grid_h: 128
  grid_w: 128

# Dataset
dataset:
  path: "./burgers2d_nu0.1_0.15_res128_t1000_n100.h5"
  temporal_length: 16
  train_ratio: 0.9
  seed: 42
  clips_per_sample: null

# Physics parameters
physics:
  dt: 0.001001001
  Lx: 1.0
  Ly: 1.0

# DataLoader
dataloader:
  batch_size: 64
  num_workers: 4
  pin_memory: true

# Training
training:
  max_epochs: 50
  warmup_steps: 200
  learning_rate: 1.0e-3
  min_lr: 1.0e-5
  weight_decay: 1.0e-4
  betas: [0.9, 0.999]
  grad_clip: 1.0

  # Loss weights
  lambda_pde: 0.01
  lambda_bc: 1.0

  # Use fp32 for full precision training
  mixed_precision: "no"
  gradient_accumulation_steps: 1
  eval_interval: 50
  early_stopping_patience: 50

# Logging
logging:
  project: "pde-unet-baseline-burgers"
  entity: "reca1c1trant-ntu"
  save_dir: "./checkpoints_unet_baseline_burgers"
  log_interval: 10

# Visualization
visualization:
  num_samples: 3
  seed: 42
